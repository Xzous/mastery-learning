<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Mastery â€” Systems of Linear Equations</title>
<link rel="preconnect" href="https://fonts.googleapis.com">
<link href="https://fonts.googleapis.com/css2?family=Nunito:wght@400;600;700;800&display=swap" rel="stylesheet">
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.16.9/dist/katex.min.css">
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.16.9/dist/katex.min.js"></script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.16.9/dist/contrib/auto-render.min.js"></script>
<style>
/* ==================== RESET ==================== */
*, *::before, *::after { box-sizing: border-box; margin: 0; padding: 0; }
:root {
  --green: #58cc02;
  --green-dark: #46a302;
  --green-light: #d7ffb8;
  --green-bg: #eaffd0;
  --red: #ff4b4b;
  --red-dark: #ea2b2b;
  --red-light: #ffdfe0;
  --blue: #1cb0f6;
  --blue-dark: #1899d6;
  --blue-light: #ddf4ff;
  --gold: #ffc800;
  --gold-dark: #e5b400;
  --purple: #ce82ff;
  --purple-light: #f0e0ff;
  --orange: #ff9600;
  --bg: #f7f7f7;
  --white: #ffffff;
  --text: #3c3c3c;
  --text-secondary: #777777;
  --text-light: #afafaf;
  --border: #e5e5e5;
  --border-dark: #d0d0d0;
  --shadow: 0 2px 4px rgba(0,0,0,0.08);
  --shadow-md: 0 4px 12px rgba(0,0,0,0.1);
  --shadow-lg: 0 8px 24px rgba(0,0,0,0.12);
  --radius: 12px;
  --radius-lg: 16px;
  --radius-xl: 24px;
  --font: 'Nunito', sans-serif;
}
html, body { height: 100%; }
body {
  font-family: var(--font);
  background: var(--bg);
  color: var(--text);
  font-size: 16px;
  line-height: 1.5;
  -webkit-font-smoothing: antialiased;
}

/* ==================== LAYOUT ==================== */
.app {
  min-height: 100vh;
  display: flex;
  flex-direction: column;
}

/* ==================== TOP BAR ==================== */
.topbar {
  background: var(--white);
  border-bottom: 2px solid var(--border);
  padding: 12px 20px;
  display: flex;
  align-items: center;
  gap: 16px;
  position: sticky;
  top: 0;
  z-index: 100;
  height: 60px;
}
.topbar-brand {
  font-size: 20px;
  font-weight: 800;
  color: var(--green);
  text-decoration: none;
  letter-spacing: -0.5px;
}
.topbar-brand:hover { text-decoration: none; }
.topbar-nav {
  display: flex;
  gap: 4px;
  margin-left: auto;
}
.topbar-nav a {
  display: flex;
  align-items: center;
  gap: 6px;
  padding: 8px 16px;
  border-radius: var(--radius);
  font-size: 14px;
  font-weight: 700;
  color: var(--text-secondary);
  text-decoration: none;
  text-transform: uppercase;
  letter-spacing: 0.5px;
  transition: all 0.15s;
  border: 2px solid transparent;
}
.topbar-nav a:hover {
  background: var(--bg);
  color: var(--text);
}
.topbar-nav a.active {
  color: var(--blue);
  border-bottom-color: var(--blue);
}
.topbar-nav .review-count {
  background: var(--red);
  color: #fff;
  font-size: 11px;
  font-weight: 800;
  padding: 1px 6px;
  border-radius: 8px;
  min-width: 18px;
  text-align: center;
}

/* ==================== BACK BUTTON ==================== */
.back-btn {
  display: flex;
  align-items: center;
  gap: 4px;
  background: none;
  border: none;
  font-family: var(--font);
  font-size: 14px;
  font-weight: 700;
  color: var(--text-secondary);
  cursor: pointer;
  padding: 6px 10px;
  border-radius: var(--radius);
  transition: all 0.15s;
}
.back-btn:hover { background: var(--bg); color: var(--text); }
.back-btn .arrow { font-size: 20px; line-height: 1; }

/* ==================== LESSON PROGRESS BAR ==================== */
.lesson-progress {
  flex: 1;
  max-width: 400px;
  height: 16px;
  background: var(--border);
  border-radius: 8px;
  overflow: hidden;
}
.lesson-progress-fill {
  height: 100%;
  background: var(--green);
  border-radius: 8px;
  transition: width 0.4s ease;
}

/* ==================== MAIN CONTENT ==================== */
.main-content {
  flex: 1;
  max-width: 680px;
  width: 100%;
  margin: 0 auto;
  padding: 32px 20px 120px;
}

/* ==================== SKILL TREE ==================== */
.skill-tree {
  display: flex;
  flex-direction: column;
  align-items: center;
  padding: 20px 0;
  gap: 0;
}
.skill-node {
  width: 80px;
  height: 80px;
  border-radius: 50%;
  display: flex;
  align-items: center;
  justify-content: center;
  font-size: 28px;
  font-weight: 800;
  cursor: pointer;
  position: relative;
  transition: transform 0.2s, box-shadow 0.2s;
  border: 4px solid;
  z-index: 2;
}
.skill-node:hover:not(.locked) { transform: scale(1.08); }
.skill-node:active:not(.locked) { transform: scale(0.96); }

.skill-node.completed {
  background: var(--gold);
  border-color: var(--gold-dark);
  color: #fff;
  box-shadow: 0 4px 0 var(--gold-dark);
}
.skill-node.current {
  background: var(--green);
  border-color: var(--green-dark);
  color: #fff;
  box-shadow: 0 4px 0 var(--green-dark);
  animation: pulse 2s ease-in-out infinite;
}
.skill-node.available {
  background: var(--white);
  border-color: var(--border-dark);
  color: var(--text-secondary);
  box-shadow: 0 4px 0 var(--border-dark);
}
.skill-node.locked {
  background: var(--border);
  border-color: var(--border-dark);
  color: var(--text-light);
  box-shadow: 0 4px 0 var(--border-dark);
  cursor: not-allowed;
  opacity: 0.6;
}

@keyframes pulse {
  0%, 100% { box-shadow: 0 4px 0 var(--green-dark), 0 0 0 0 rgba(88,204,2,0.3); }
  50% { box-shadow: 0 4px 0 var(--green-dark), 0 0 0 12px rgba(88,204,2,0); }
}

.skill-label {
  text-align: center;
  margin-top: 8px;
  margin-bottom: 4px;
  font-size: 14px;
  font-weight: 700;
  color: var(--text);
  max-width: 140px;
}
.skill-label.locked { color: var(--text-light); }

.skill-sublabel {
  text-align: center;
  font-size: 12px;
  color: var(--text-secondary);
  margin-bottom: 8px;
}

.skill-connector {
  width: 4px;
  height: 32px;
  background: var(--border-dark);
  border-radius: 2px;
}
.skill-connector.completed { background: var(--gold); }

.skill-group {
  display: flex;
  flex-direction: column;
  align-items: center;
}

/* ==================== SECTION HEADER ==================== */
.section-header {
  text-align: center;
  margin-bottom: 32px;
}
.section-header h1 {
  font-size: 28px;
  font-weight: 800;
  margin-bottom: 4px;
}
.section-header p {
  color: var(--text-secondary);
  font-size: 16px;
}

/* ==================== LESSON CARD (question container) ==================== */
.lesson-card {
  background: var(--white);
  border: 2px solid var(--border);
  border-radius: var(--radius-lg);
  padding: 32px 28px;
  text-align: center;
  box-shadow: var(--shadow);
  margin-bottom: 20px;
}
.lesson-prompt {
  font-size: 22px;
  font-weight: 700;
  color: var(--text);
  margin-bottom: 8px;
  line-height: 1.4;
}
.lesson-subprompt {
  font-size: 15px;
  color: var(--text-secondary);
  margin-bottom: 24px;
}
.lesson-context {
  background: var(--bg);
  border-radius: var(--radius);
  padding: 14px 18px;
  margin-bottom: 20px;
  font-size: 15px;
  color: var(--text);
  text-align: left;
  font-family: 'Courier New', monospace;
  line-height: 1.6;
}

/* ==================== INPUT STYLES ==================== */
.answer-input {
  width: 100%;
  border: 2px solid var(--border);
  border-radius: var(--radius);
  padding: 14px 18px;
  font-size: 17px;
  font-family: var(--font);
  color: var(--text);
  background: var(--white);
  transition: border-color 0.2s;
  text-align: left;
}
.answer-input:focus {
  outline: none;
  border-color: var(--blue);
  box-shadow: 0 0 0 3px rgba(28,176,246,0.15);
}
.answer-input::placeholder { color: var(--text-light); }

textarea.answer-input {
  min-height: 80px;
  resize: vertical;
  line-height: 1.5;
}
.answer-input.correct {
  border-color: var(--green);
  background: var(--green-bg);
}
.answer-input.incorrect {
  border-color: var(--red);
  background: var(--red-light);
}

/* ==================== ACTION BAR (sticky bottom) ==================== */
.action-bar {
  position: fixed;
  bottom: 0;
  left: 0;
  right: 0;
  background: var(--white);
  border-top: 2px solid var(--border);
  padding: 16px 20px;
  display: flex;
  justify-content: center;
  z-index: 99;
}
.action-bar .action-inner {
  max-width: 680px;
  width: 100%;
  display: flex;
  flex-direction: column;
  gap: 8px;
}

/* ==================== BUTTONS ==================== */
.btn {
  display: inline-flex;
  align-items: center;
  justify-content: center;
  gap: 8px;
  padding: 14px 32px;
  border-radius: var(--radius-lg);
  font-size: 16px;
  font-weight: 800;
  font-family: var(--font);
  text-transform: uppercase;
  letter-spacing: 0.8px;
  border: none;
  cursor: pointer;
  transition: all 0.15s;
  text-decoration: none;
}
.btn:active { transform: translateY(2px); }
.btn:disabled { opacity: 0.5; cursor: not-allowed; transform: none; }

.btn-check {
  background: var(--green);
  color: #fff;
  box-shadow: 0 4px 0 var(--green-dark);
  width: 100%;
}
.btn-check:hover:not(:disabled) { background: #4fbb02; }
.btn-check:active { box-shadow: 0 2px 0 var(--green-dark); }

.btn-skip {
  background: transparent;
  color: var(--text-secondary);
  border: 2px solid var(--border);
  box-shadow: 0 4px 0 var(--border-dark);
  width: 100%;
}
.btn-skip:hover { background: var(--bg); }

.btn-continue {
  width: 100%;
  padding: 14px 32px;
  border-radius: var(--radius-lg);
  font-size: 16px;
  font-weight: 800;
  font-family: var(--font);
  text-transform: uppercase;
  letter-spacing: 0.8px;
  border: none;
  cursor: pointer;
  color: #fff;
}
.btn-continue.correct-btn {
  background: var(--green);
  box-shadow: 0 4px 0 var(--green-dark);
}
.btn-continue.incorrect-btn {
  background: var(--red);
  box-shadow: 0 4px 0 var(--red-dark);
}

.btn-primary {
  background: var(--blue);
  color: #fff;
  box-shadow: 0 4px 0 var(--blue-dark);
}
.btn-primary:hover { background: #19a4e6; }

.btn-gold {
  background: var(--gold);
  color: #fff;
  box-shadow: 0 4px 0 var(--gold-dark);
}

.btn-secondary {
  background: var(--white);
  color: var(--text);
  border: 2px solid var(--border);
  box-shadow: 0 4px 0 var(--border-dark);
}

.btn-sm {
  padding: 8px 18px;
  font-size: 13px;
  border-radius: var(--radius);
}

/* ==================== FEEDBACK BAR ==================== */
.feedback-bar {
  padding: 16px 20px;
  border-radius: var(--radius);
  display: flex;
  align-items: center;
  gap: 12px;
  font-weight: 700;
  font-size: 17px;
  margin-bottom: 8px;
}
.feedback-bar.correct {
  background: var(--green-light);
  color: var(--green-dark);
}
.feedback-bar.incorrect {
  background: var(--red-light);
  color: var(--red-dark);
}
.feedback-bar .feedback-icon { font-size: 24px; }
.feedback-bar .feedback-detail {
  font-size: 14px;
  font-weight: 600;
  opacity: 0.85;
  margin-top: 2px;
}

/* ==================== HINT ==================== */
.hint-box {
  background: var(--purple-light);
  border-radius: var(--radius);
  padding: 12px 16px;
  margin-top: 16px;
  font-size: 14px;
  color: #7b2ff2;
  text-align: left;
}
.hint-box strong {
  display: block;
  font-size: 12px;
  text-transform: uppercase;
  letter-spacing: 0.5px;
  margin-bottom: 4px;
  opacity: 0.8;
}

/* ==================== TOPIC PAGE ==================== */
.topic-header {
  text-align: center;
  padding: 24px 0;
}
.topic-header h1 {
  font-size: 26px;
  font-weight: 800;
}
.topic-header .topic-badge {
  display: inline-flex;
  align-items: center;
  gap: 6px;
  padding: 4px 14px;
  border-radius: 20px;
  font-size: 13px;
  font-weight: 700;
  margin-top: 8px;
}
.topic-badge.mastered { background: var(--green-light); color: var(--green-dark); }
.topic-badge.in-progress { background: #fff3d0; color: #b8860b; }
.topic-badge.available { background: var(--blue-light); color: var(--blue-dark); }

.topic-section {
  background: var(--white);
  border: 2px solid var(--border);
  border-radius: var(--radius-lg);
  margin-bottom: 16px;
  overflow: hidden;
}
.topic-section-header {
  padding: 16px 20px;
  font-size: 13px;
  font-weight: 800;
  text-transform: uppercase;
  letter-spacing: 0.8px;
  color: var(--text-secondary);
  border-bottom: 2px solid var(--border);
  background: var(--bg);
}
.topic-item {
  padding: 14px 20px;
  display: flex;
  align-items: center;
  gap: 14px;
  border-bottom: 1px solid var(--border);
  cursor: pointer;
  transition: background 0.15s;
}
.topic-item:last-child { border-bottom: none; }
.topic-item:hover { background: var(--bg); }

.topic-item-icon {
  width: 40px;
  height: 40px;
  border-radius: 50%;
  display: flex;
  align-items: center;
  justify-content: center;
  font-size: 18px;
  flex-shrink: 0;
  font-weight: 700;
}
.topic-item-icon.green { background: var(--green-light); color: var(--green-dark); }
.topic-item-icon.blue { background: var(--blue-light); color: var(--blue-dark); }
.topic-item-icon.gold { background: #fff3d0; color: #b8860b; }
.topic-item-icon.gray { background: #eee; color: var(--text-light); }

.topic-item-info { flex: 1; }
.topic-item-name { font-weight: 700; font-size: 15px; }
.topic-item-detail { font-size: 13px; color: var(--text-secondary); }

.topic-item-progress {
  width: 80px;
}
.mini-progress {
  height: 8px;
  background: var(--border);
  border-radius: 4px;
  overflow: hidden;
}
.mini-progress-fill {
  height: 100%;
  border-radius: 4px;
  transition: width 0.3s;
}
.mini-progress-fill.green { background: var(--green); }
.mini-progress-fill.gold { background: var(--gold); }

/* ==================== COMPLETION SCREEN ==================== */
.completion-screen {
  text-align: center;
  padding: 48px 20px;
}
.completion-icon {
  font-size: 64px;
  margin-bottom: 16px;
}
.completion-title {
  font-size: 28px;
  font-weight: 800;
  margin-bottom: 8px;
}
.completion-subtitle {
  font-size: 16px;
  color: var(--text-secondary);
  margin-bottom: 32px;
}
.completion-stats {
  display: flex;
  justify-content: center;
  gap: 32px;
  margin-bottom: 32px;
}
.completion-stat {
  text-align: center;
}
.completion-stat-value {
  font-size: 32px;
  font-weight: 800;
  color: var(--green);
}
.completion-stat-label {
  font-size: 13px;
  color: var(--text-secondary);
  font-weight: 700;
}

/* ==================== REVIEW CARD ==================== */
.review-header {
  text-align: center;
  padding: 12px 0 24px;
}
.review-header h2 {
  font-size: 20px;
  font-weight: 800;
  color: var(--text);
}
.review-tag {
  display: inline-block;
  padding: 3px 12px;
  border-radius: 20px;
  font-size: 12px;
  font-weight: 700;
  background: var(--blue-light);
  color: var(--blue-dark);
  margin-bottom: 8px;
}

/* ==================== STATS CARDS ==================== */
.stats-row {
  display: grid;
  grid-template-columns: repeat(auto-fit, minmax(140px, 1fr));
  gap: 12px;
  margin-bottom: 28px;
}
.stat-card {
  background: var(--white);
  border: 2px solid var(--border);
  border-radius: var(--radius);
  padding: 16px;
  text-align: center;
}
.stat-card-value {
  font-size: 28px;
  font-weight: 800;
}
.stat-card-value.green { color: var(--green); }
.stat-card-value.blue { color: var(--blue); }
.stat-card-value.gold { color: var(--gold-dark); }
.stat-card-value.red { color: var(--red); }
.stat-card-label {
  font-size: 12px;
  font-weight: 700;
  color: var(--text-secondary);
  text-transform: uppercase;
  letter-spacing: 0.3px;
}

/* ==================== VIZ ==================== */
.viz-container {
  position: relative;
  width: 100%;
  height: 420px;
  background: #1a1a2e;
  border-radius: var(--radius-lg);
  overflow: hidden;
  border: 2px solid var(--border);
}
.viz-container canvas { width: 100% !important; height: 100% !important; }
.viz-locked-overlay {
  position: absolute;
  inset: 0;
  background: rgba(0,0,0,0.85);
  display: flex;
  flex-direction: column;
  align-items: center;
  justify-content: center;
  gap: 12px;
  z-index: 10;
  color: #fff;
}
.viz-locked-overlay .lock-icon { font-size: 48px; opacity: 0.5; }
.viz-locked-overlay .lock-message { font-size: 16px; opacity: 0.8; text-align: center; max-width: 300px; }
.viz-locked-overlay .lock-requirements { list-style: none; margin-top: 8px; }
.viz-locked-overlay .lock-requirements li { font-size: 14px; padding: 3px 0; }
.viz-locked-overlay .lock-requirements li.met { color: var(--green); }
.viz-locked-overlay .lock-requirements li.unmet { color: #888; }
.viz-controls {
  padding: 10px 16px;
  font-size: 13px;
  color: var(--text-secondary);
  text-align: center;
  background: var(--white);
  border: 2px solid var(--border);
  border-top: none;
  border-radius: 0 0 var(--radius-lg) var(--radius-lg);
}

/* ==================== TEACH VISUALIZATION (inline in explain-card) ==================== */
.explain-card.visual {
  border-left-color: #7c4dff;
}
.explain-card.visual .explain-label {
  color: #7c4dff;
}
.teach-viz-container {
  position: relative;
  width: 100%;
  height: 300px;
  background: #0a0e14;
  border-radius: var(--radius);
  overflow: hidden;
  margin-top: 16px;
  border: 1px solid #2a2a40;
}
.teach-viz-container canvas {
  width: 100% !important;
  height: 100% !important;
  display: block;
}
.teach-viz-hint {
  text-align: center;
  font-size: 12px;
  color: var(--text-light);
  margin-top: 8px;
  font-weight: 600;
}
@media (max-width: 600px) {
  .teach-viz-container { height: 240px; }
}

/* ==================== PROOF STEPS ==================== */
.proof-step {
  background: var(--white);
  border: 2px solid var(--border);
  border-radius: var(--radius);
  margin-bottom: 12px;
  overflow: hidden;
  transition: border-color 0.2s;
}
.proof-step.active { border-color: var(--blue); }
.proof-step.completed { border-color: var(--green); }
.proof-step.locked { opacity: 0.4; }
.proof-step-header {
  padding: 12px 16px;
  display: flex;
  align-items: center;
  gap: 12px;
  font-weight: 700;
  font-size: 14px;
  background: var(--bg);
  border-bottom: 1px solid var(--border);
}
.step-number {
  width: 28px;
  height: 28px;
  border-radius: 50%;
  display: flex;
  align-items: center;
  justify-content: center;
  font-size: 13px;
  font-weight: 800;
  flex-shrink: 0;
}
.proof-step.completed .step-number { background: var(--green-light); color: var(--green-dark); }
.proof-step.active .step-number { background: var(--blue-light); color: var(--blue-dark); }
.proof-step.locked .step-number { background: #eee; color: var(--text-light); }
.proof-step-body { padding: 16px; }
.proof-step.locked .proof-step-body { display: none; }
.completed-answer {
  background: var(--green-bg);
  border-radius: var(--radius);
  padding: 12px 14px;
  font-size: 14px;
  color: var(--green-dark);
  font-family: 'Courier New', monospace;
}

/* ==================== EMPTY STATE ==================== */
.empty-state {
  text-align: center;
  padding: 48px 20px;
}
.empty-state .empty-icon { font-size: 64px; margin-bottom: 16px; }
.empty-state h2 { font-size: 22px; font-weight: 800; margin-bottom: 8px; }
.empty-state p { color: var(--text-secondary); margin-bottom: 24px; }

/* ==================== HEATMAP ==================== */
.heatmap-table {
  width: 100%;
  border-collapse: collapse;
  font-size: 14px;
}
.heatmap-table th {
  text-align: left;
  padding: 10px 12px;
  font-size: 12px;
  font-weight: 700;
  text-transform: uppercase;
  color: var(--text-secondary);
  border-bottom: 2px solid var(--border);
}
.heatmap-table td {
  padding: 10px 12px;
  border-bottom: 1px solid var(--border);
}
.heatmap-cell {
  display: inline-block;
  width: 32px;
  height: 32px;
  border-radius: 6px;
  text-align: center;
  line-height: 32px;
  font-size: 12px;
  font-weight: 800;
}
.heatmap-0 { background: #f0f0f0; color: #ccc; }
.heatmap-1 { background: var(--green-light); color: var(--green-dark); }
.heatmap-2 { background: #fff3d0; color: #b8860b; }
.heatmap-3 { background: #ffe0cc; color: #cc5500; }
.heatmap-4 { background: var(--red-light); color: var(--red-dark); }

/* ==================== EXPLANATION CARDS (Brilliant-style) ==================== */
.explain-card {
  background: var(--white);
  border: 2px solid var(--border);
  border-radius: var(--radius-lg);
  padding: 28px;
  border-left: 5px solid var(--blue);
  margin-bottom: 20px;
  box-shadow: var(--shadow);
  text-align: left;
}
.explain-card.intro {
  border-left-color: var(--green);
  background: linear-gradient(135deg, #f6fff0 0%, var(--white) 100%);
}
.explain-card.axiom {
  border-left-color: var(--purple);
}
.explain-card .explain-label {
  font-size: 11px;
  font-weight: 800;
  text-transform: uppercase;
  letter-spacing: 1px;
  color: var(--blue);
  margin-bottom: 8px;
}
.explain-card.intro .explain-label { color: var(--green-dark); }
.explain-card.axiom .explain-label { color: var(--purple); }
.explain-card .explain-title {
  font-size: 20px;
  font-weight: 800;
  margin-bottom: 12px;
  color: var(--text);
  line-height: 1.3;
}
.explain-card .explain-body {
  font-size: 16px;
  line-height: 1.7;
  color: var(--text);
}
.explain-card .explain-example {
  background: #f0f7ff;
  border-radius: var(--radius);
  padding: 14px 16px;
  margin-top: 14px;
  font-size: 14px;
  color: #1a5276;
  line-height: 1.6;
  border: 1px solid #d4e6f7;
}
.explain-card.axiom .explain-example {
  background: #f8f0ff;
  border-color: #e4d0f7;
  color: #4a1a7a;
}
.explain-card .explain-formula {
  background: var(--bg);
  border-radius: var(--radius);
  padding: 14px 16px;
  margin-top: 12px;
  font-size: 16px;
  text-align: center;
  color: var(--text);
  border: 1px solid var(--border);
  overflow-x: auto;
}
.katex { font-size: 1.1em; }
.explain-formula .katex { font-size: 1.25em; }
.explain-example .katex { font-size: 1.05em; }
.mc-text .katex { font-size: 1em; }
.lesson-prompt .katex { font-size: 1.1em; }
.explain-card .explain-key {
  background: var(--blue-light);
  padding: 1px 6px;
  border-radius: 4px;
  font-weight: 700;
  color: var(--blue-dark);
}

/* ==================== MULTIPLE CHOICE TILES ==================== */
.mc-choices {
  display: flex;
  flex-direction: column;
  gap: 10px;
  margin-top: 20px;
  text-align: left;
}
.mc-tile {
  display: flex;
  align-items: center;
  gap: 14px;
  width: 100%;
  padding: 14px 18px;
  border: 2px solid var(--border);
  border-radius: var(--radius);
  background: var(--white);
  font-family: var(--font);
  font-size: 16px;
  font-weight: 600;
  color: var(--text);
  cursor: pointer;
  transition: all 0.15s;
  text-align: left;
}
.mc-tile:hover:not(.locked) {
  border-color: var(--blue);
  background: var(--blue-light);
}
.mc-tile.selected {
  border-color: var(--blue);
  background: var(--blue-light);
  box-shadow: 0 0 0 2px rgba(28,176,246,0.2);
}
.mc-tile.locked { cursor: default; opacity: 0.85; }
.mc-tile.correct {
  border-color: var(--green);
  background: var(--green-bg);
  opacity: 1;
}
.mc-tile.incorrect {
  border-color: var(--red);
  background: var(--red-light);
  opacity: 1;
}
.mc-letter {
  width: 32px;
  height: 32px;
  border-radius: 8px;
  display: flex;
  align-items: center;
  justify-content: center;
  font-size: 14px;
  font-weight: 800;
  background: var(--bg);
  color: var(--text-secondary);
  border: 2px solid var(--border);
  flex-shrink: 0;
  transition: all 0.15s;
}
.mc-tile.selected .mc-letter {
  background: var(--blue);
  color: #fff;
  border-color: var(--blue-dark);
}
.mc-tile.correct .mc-letter {
  background: var(--green);
  color: #fff;
  border-color: var(--green-dark);
}
.mc-tile.incorrect .mc-letter {
  background: var(--red);
  color: #fff;
  border-color: var(--red-dark);
}
.mc-text { flex: 1; line-height: 1.4; }

/* ==================== HINT BUTTON ==================== */
.hint-toggle {
  display: inline-flex;
  align-items: center;
  gap: 6px;
  background: none;
  border: 2px solid var(--purple);
  border-radius: var(--radius);
  padding: 6px 14px;
  font-family: var(--font);
  font-size: 13px;
  font-weight: 700;
  color: var(--purple);
  cursor: pointer;
  margin-top: 14px;
  transition: all 0.15s;
}
.hint-toggle:hover {
  background: var(--purple-light);
}

/* ==================== SLIDE COUNTER ==================== */
.slide-counter {
  font-size: 13px;
  font-weight: 700;
  color: var(--text-light);
  text-align: center;
  margin-bottom: 8px;
}

/* ==================== ANIMATIONS ==================== */
@keyframes slideUp {
  from { opacity: 0; transform: translateY(20px); }
  to { opacity: 1; transform: translateY(0); }
}
@keyframes bounceIn {
  0% { transform: scale(0.3); opacity: 0; }
  50% { transform: scale(1.05); }
  70% { transform: scale(0.95); }
  100% { transform: scale(1); opacity: 1; }
}
@keyframes confettiBurst {
  0% { transform: translateY(0) rotate(0); opacity: 1; }
  100% { transform: translateY(-100px) rotate(720deg); opacity: 0; }
}
.animate-slide-up { animation: slideUp 0.3s ease; }
.animate-bounce { animation: bounceIn 0.5s ease; }

/* ==================== RESPONSIVE ==================== */
@media (max-width: 600px) {
  .main-content { padding: 20px 12px 120px; }
  .lesson-prompt { font-size: 18px; }
  .lesson-card { padding: 24px 16px; }
  .topbar-nav a span.nav-label { display: none; }
  .stats-row { grid-template-columns: 1fr 1fr; }
  .completion-stats { gap: 20px; }
}
</style>
</head>
<body>
<div class="app">
  <header class="topbar" id="topbar">
    <a href="#dashboard" class="topbar-brand">MASTERY</a>
    <nav class="topbar-nav" id="topbar-nav">
      <a href="#dashboard" data-route="dashboard"><span class="nav-label">Learn</span></a>
      <a href="#review" data-route="review"><span class="nav-label">Review</span><span class="review-count" id="due-badge" style="display:none">0</span></a>
      <a href="#progress" data-route="progress"><span class="nav-label">Progress</span></a>
    </nav>
  </header>

  <main class="main-content" id="main-content">
  </main>
</div>

<!-- Content Registry -->
<script>
window.ContentRegistry = {
  courses: {},
  register(course) {
    this.courses[course.id] = course;
    course._topicMap = {};
    course._defMap = {};
    course._proofMap = {};
    course._vizMap = {};
    (course.topics || []).forEach(t => {
      course._topicMap[t.id] = t;
      (t.definitions || []).forEach(d => { course._defMap[d.id] = d; d._topicId = t.id; });
      (t.proofs || []).forEach(p => { course._proofMap[p.id] = p; p._topicId = t.id; });
      if (t.visualization) { course._vizMap[t.id] = t.visualization; }
    });
  },
  getCourse(id) { return this.courses[id]; },
  getAllCourses() { return Object.values(this.courses); },
  getTopics(courseId) { const c = this.courses[courseId]; return c ? c.topics : []; },
  getTopic(courseId, topicId) { const c = this.courses[courseId]; return c ? c._topicMap[topicId] : null; },
  getDefinition(courseId, defId) { const c = this.courses[courseId]; return c ? c._defMap[defId] : null; },
  getProof(courseId, proofId) { const c = this.courses[courseId]; return c ? c._proofMap[proofId] : null; },
  getVisualization(courseId, topicId) { const c = this.courses[courseId]; return c ? c._vizMap[topicId] : null; },
  getAllDefinitions(courseId) { const c = this.courses[courseId]; return c ? Object.values(c._defMap) : []; },
  getAllProofs(courseId) { const c = this.courses[courseId]; return c ? Object.values(c._proofMap) : []; }
};
</script>

<!-- Libraries -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/three.js/r128/three.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/three@0.128.0/examples/js/controls/OrbitControls.js"></script>

<!-- Engine -->
<script src="js/utils.js"></script>
<script src="js/persistence.js"></script>
<script src="js/router.js"></script>
<script src="js/spaced-repetition.js"></script>
<script src="js/definition-engine.js"></script>
<script src="js/proof-engine.js"></script>
<script src="js/visualization.js"></script>
<script src="js/teach-viz.js"></script>
<script src="js/dashboard.js"></script>
<script src="js/app.js"></script>

<!-- Content -->
<script src="content/linear-algebra.js"></script>

<!-- Init -->
<script>
  document.addEventListener('DOMContentLoaded', () => App.init());
</script>
</body>
</html>
